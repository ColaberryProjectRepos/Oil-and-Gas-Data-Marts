
Create and Load Fact Tables
13
<p><span style="background-color: rgb(0, 255, 0);"><b>**NOTE:</b></span>&nbsp;Download the attached file with SQL scripts to create Fact tables and SQL Update statements.</p><p>Create a new package and rename it as shown below</p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/857/11/1.jpg"></p><p><br></p><p>In the Control Flow pane, drag and drop a Sequence Container</p><p>Drag and drop two Data Flow Tasks into the Sequence Container and rename all as shown below</p><p>Create two SQL Views to join dimension tables and DW staging so as to load Fact tables (see attached for script)</p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/857/11/2.jpg"></p><p><br></p><p>Double-click on Fact_Financials_CapEx to move to the Data Flow pane and process accordingly</p><p>Drag and drop the OLE DB Source, rename, and double-click to configure</p><p>Select the connection manager</p><p>Write SQL Command to obtain columns from created View</p><p>Click on the Column options and map columns accordingly and click OK</p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/857/11/3.jpg"></p><p><br></p><p>Drag and drop the Derived Column transformation, connect, rename and double-click to configure</p><p>Add new columns (fields) as shown below, and click OK</p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/857/11/4.jpg"></p><p><br></p><p>Drag and drop 8 Lookup transformations, connect and name them a shown below</p><p>Double-click on Dim_RegionKey to configure</p><p>Select the cache mode and connection type</p><p>Specify how to handle rows with no matching entries</p><p>Click the connection option and select the connection manager and target table</p><p>Click on the Columns option to map Keys and then click OK</p><p><br></p><p>Created the GIF below to load Fact_Financial_CapEx.</p><p>Follow the steps on the GIF to load DIM_Businessegment key and DIM_Companykey.</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; letter-spacing: 0.3px;"><br></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/857/13/5.gif"><br></p><p><br></p><p style="letter-spacing: 0.3px;">Created the GIF below to load Fact_Financial_CapEx.</p><p style="letter-spacing: 0.3px;">Follow the steps on the GIF to load DIM_Currencykey, DIM_RegionKey and DIM_PerformanceStatuskey.</p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/857/13/6.gif"><br></p><p><br></p><p style="letter-spacing: 0.3px;">Created the GIF below to load Fact_Financial_CapEx.</p><p style="letter-spacing: 0.3px;">Follow the steps on the GIF to load DIM_Industrykey, DIM_DateKey and DIM_PerformanceStatuskey.</p><p style="letter-spacing: 0.3px;"><img src="https://app.colaberry.com/uploads/ProjectStepsImages/857/13/7.gif"><br></p><p><br></p><p style="letter-spacing: 0.3px;">Created the GIF below to load Fact_Financial_CapEx.</p><p style="letter-spacing: 0.3px;">Follow the steps on the GIF to load DIM_Industrykey, DIM_IndustryKey and DIM_Matchingkey.</p><p style="letter-spacing: 0.3px;"><img src="https://app.colaberry.com/uploads/ProjectStepsImages/857/13/8.gif"><br></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/857/11/5.jpg"></p><p>**<span style="background-color: rgb(255, 0, 0);"><b>NOTE:</b></span><span style="background-color: rgb(255, 198, 156);"> Follow the above steps to configure all the Lookup transformations</span></p><p><br></p><p><br></p><p>Drag and drop the OLE DB destination, connect, rename and double-click to configure</p><p>Select the connection manager and target table</p><p>Click on the Mappings options to map columns accordingly</p><p>Click OK</p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/857/11/6.jpg"></p><p><br></p><p>Drag and drop the OLE DB Command transformation, connect, rename and double-click to configure&nbsp;</p><p>Select the connection Manager</p><p>Click on the Component Properties option and add the SQL Update statement as shown below (check attached for script)</p><p>Click on the Column Mappings option to map columns then click OK</p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/857/11/7.jpg"></p><p><br></p><p><span style="background-color: rgb(255, 0, 0);"><b>**NOTE: </b></span><span style="background-color: rgb(255, 198, 156);">Follow the same steps above to configure and load Fact_Financials_LOE</span></p><p>Execute package and run SQL Select statement to make sure tables are loaded correctly</p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/857/11/8.jpg"><br></p><p><span style="color: rgb(34, 34, 34); font-family: Roboto, RobotoDraft, Helvetica, Arial, sans-serif; font-size: small; letter-spacing: normal;"><br></span></p><p><span style="color: rgb(34, 34, 34); font-family: Roboto, RobotoDraft, Helvetica, Arial, sans-serif; font-size: small; letter-spacing: normal;"><br></span></p><p><span style="color: rgb(34, 34, 34); font-family: Roboto, RobotoDraft, Helvetica, Arial, sans-serif; font-size: small; letter-spacing: normal;">A picture&nbsp; of the Data Model.</span></p><p><img src = "https://app.colaberry.com/uploads/ProjectStepsImages/857/13/13.jpg" /><span style="color: rgb(34, 34, 34); font-family: Roboto, RobotoDraft, Helvetica, Arial, sans-serif; font-size: small; letter-spacing: normal;"><br></span></p><p><br></p><p><br></p>

<p>Time Series Data Fact and Dimension Tables for SQL Server:&nbsp;<a href="https://www.mssqltips.com/sqlservertip/6287/time-series-data-fact-and-dimension-tables-for-sql-server/" target="_blank">https://www.mssqltips.com/sqlservertip/6287/time-series-data-fact-and-dimension-tables-for-sql-server/</a></p>

